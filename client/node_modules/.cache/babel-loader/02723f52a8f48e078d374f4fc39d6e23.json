{"ast":null,"code":"import _slicedToArray from \"/home/benjamin/Desktop/react_studio/goal-sharer/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/home/benjamin/Desktop/react_studio/goal-sharer/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"/home/benjamin/Desktop/react_studio/goal-sharer/client/src/components/layout/Signup.js\";\nimport React, { useState, useReducer } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport GoalIcon from \"../GoalIcon\";\nimport { TextField, Button, makeStyles, Container, CssBaseline, Grid } from \"@material-ui/core\";\nconst useStyles = makeStyles(theme => ({\n  paper: {\n    marginTop: theme.spacing(8),\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\"\n  },\n  goalBook: {\n    fontWeight: \"500\",\n    fontFamily: \"Ma Shan Zheng\",\n    color: \"#424242\"\n  },\n  submit: {\n    margin: theme.spacing(2, 0, 2)\n  },\n  form: {\n    marginTop: theme.spacing(5)\n  }\n}));\n\nconst Signup = () => {\n  const classes = useStyles();\n  const initialState = {\n    token: localStorage.getItem(\"token\"),\n    isAuthenticated: null,\n    loading: true,\n    user: null\n  };\n\n  const reducer = (state, action) => {\n    const type = action.type,\n          payload = action.payload;\n\n    switch (type) {\n      case \"register_success\":\n        localStorage.setItem(\"token\", payload.token);\n        return _objectSpread({}, state, {}, payload, {\n          isAuthenticated: true,\n          loading: false\n        });\n\n      case \"register_fail\":\n        localStorage.removeItem(\"token\");\n        return _objectSpread({}, state, {\n          token: null,\n          isAuthenticated: false,\n          loading: false\n        });\n\n      default:\n        return state;\n    }\n  };\n\n  const _useState = useState({\n    first_name: \"\",\n    last_name: \"\",\n    email: \"\",\n    password: \"\",\n    password2: \"\"\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        formData = _useState2[0],\n        setFormData = _useState2[1];\n\n  const first_name = formData.first_name,\n        last_name = formData.last_name,\n        email = formData.email,\n        password = formData.password,\n        password2 = formData.password2;\n\n  const handleOnChange = e => {\n    if (formData.error) {\n      setFormData(_objectSpread({}, formData, {\n        error: false\n      }));\n    } else {\n      setFormData(_objectSpread({}, formData, {\n        [e.target.name]: e.target.value\n      }));\n    }\n  };\n\n  const _useReducer = useReducer(reducer, initialState),\n        _useReducer2 = _slicedToArray(_useReducer, 2),\n        userState = _useReducer2[0],\n        dispatch = _useReducer2[1];\n\n  const handleOnSubmit = e => {\n    e.preventDefault();\n\n    if (password !== password2) {\n      return setFormData(_objectSpread({}, formData, {\n        error: true\n      }));\n    } else {\n      const register = async ({\n        first_name,\n        last_name,\n        email,\n        password\n      }) => {\n        const config = {\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        };\n        const body = JSON.stringify({\n          first_name,\n          last_name,\n          email,\n          password\n        });\n        console.log(\"Action is being called\");\n\n        try {\n          const res = await axios.post(\"/api/users/signup\", body, config);\n          dispatch({\n            type: \"register_success\",\n            payload: res.data\n          });\n        } catch (error) {\n          dispatch({\n            type: \"register_fail\"\n          });\n        }\n      };\n\n      register({\n        first_name,\n        last_name,\n        email,\n        password\n      });\n    }\n  };\n\n  return React.createElement(Container, {\n    component: \"main\",\n    maxWidth: \"xs\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, React.createElement(CssBaseline, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: classes.paper,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, React.createElement(GoalIcon, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }), React.createElement(\"form\", {\n    className: classes.form,\n    onSubmit: e => handleOnSubmit(e),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    container: true,\n    spacing: 1,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, React.createElement(TextField, {\n    name: \"first_name\",\n    value: first_name,\n    onChange: e => handleOnChange(e),\n    label: \"First Name\",\n    fullWidth: true,\n    variant: \"outlined\",\n    required: true,\n    margin: \"normal\",\n    autoComplete: \"none\",\n    autoFocus: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  })), React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, React.createElement(TextField, {\n    label: \"Last Name\",\n    name: \"last_name\",\n    value: last_name,\n    onChange: e => handleOnChange(e),\n    fullWidth: true,\n    variant: \"outlined\",\n    required: true,\n    margin: \"normal\",\n    autoComplete: \"none\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }))), React.createElement(Grid, {\n    container: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, React.createElement(TextField, {\n    label: \"Email\",\n    fullWidth: true,\n    variant: \"outlined\",\n    required: true,\n    margin: \"normal\",\n    name: \"email\",\n    value: email,\n    onChange: e => handleOnChange(e),\n    autoComplete: \"none\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  })), React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }, React.createElement(TextField, {\n    error: formData.error,\n    label: \"Password\",\n    name: \"password\",\n    value: password,\n    type: \"password\",\n    onChange: e => handleOnChange(e),\n    fullWidth: true,\n    variant: \"outlined\",\n    required: true,\n    margin: \"normal\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  })), React.createElement(Grid, {\n    item: true,\n    xs: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, React.createElement(TextField, {\n    error: formData.error,\n    helperText: formData.error ? \"Passwords do not match\" : null,\n    type: \"password\",\n    label: \"Confirm Password\",\n    fullWidth: true,\n    variant: \"outlined\",\n    required: true,\n    margin: \"normal\",\n    name: \"password2\",\n    value: password2,\n    onChange: e => handleOnChange(e),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }))), React.createElement(Button, {\n    color: \"primary\",\n    variant: \"contained\",\n    fullWidth: true,\n    type: \"submit\",\n    className: classes.submit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, \"Sign Up\"), React.createElement(Link, {\n    to: \"/\",\n    style: {\n      textDecoration: \"none\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208\n    },\n    __self: this\n  }, \"Already have an account? Login\"))));\n};\n\nexport default Signup;","map":{"version":3,"sources":["/home/benjamin/Desktop/react_studio/goal-sharer/client/src/components/layout/Signup.js"],"names":["React","useState","useReducer","Link","axios","GoalIcon","TextField","Button","makeStyles","Container","CssBaseline","Grid","useStyles","theme","paper","marginTop","spacing","display","flexDirection","alignItems","goalBook","fontWeight","fontFamily","color","submit","margin","form","Signup","classes","initialState","token","localStorage","getItem","isAuthenticated","loading","user","reducer","state","action","type","payload","setItem","removeItem","first_name","last_name","email","password","password2","formData","setFormData","handleOnChange","e","error","target","name","value","userState","dispatch","handleOnSubmit","preventDefault","register","config","headers","body","JSON","stringify","console","log","res","post","data","textDecoration"],"mappings":"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","sourcesContent":["import React, { useState, useReducer } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport axios from \"axios\";\nimport GoalIcon from \"../GoalIcon\";\nimport {\n  TextField,\n  Button,\n  makeStyles,\n  Container,\n  CssBaseline,\n  Grid\n} from \"@material-ui/core\";\n\nconst useStyles = makeStyles(theme => ({\n  paper: {\n    marginTop: theme.spacing(8),\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\"\n  },\n  goalBook: {\n    fontWeight: \"500\",\n    fontFamily: \"Ma Shan Zheng\",\n    color: \"#424242\"\n  },\n  submit: {\n    margin: theme.spacing(2, 0, 2)\n  },\n  form: {\n    marginTop: theme.spacing(5)\n  }\n}));\n\nconst Signup = () => {\n  const classes = useStyles();\n\n  const initialState = {\n    token: localStorage.getItem(\"token\"),\n    isAuthenticated: null,\n    loading: true,\n    user: null\n  };\n\n  const reducer = (state, action) => {\n    const { type, payload } = action;\n    switch (type) {\n      case \"register_success\":\n        localStorage.setItem(\"token\", payload.token);\n        return {\n          ...state,\n          ...payload,\n          isAuthenticated: true,\n          loading: false\n        };\n      case \"register_fail\":\n        localStorage.removeItem(\"token\");\n        return {\n          ...state,\n          token: null,\n          isAuthenticated: false,\n          loading: false\n        };\n      default:\n        return state;\n    }\n  };\n\n  const [formData, setFormData] = useState({\n    first_name: \"\",\n    last_name: \"\",\n    email: \"\",\n    password: \"\",\n    password2: \"\"\n  });\n\n  const { first_name, last_name, email, password, password2 } = formData;\n\n  const handleOnChange = e => {\n    if (formData.error) {\n      setFormData({ ...formData, error: false });\n    } else {\n      setFormData({ ...formData, [e.target.name]: e.target.value });\n    }\n  };\n\n  const [userState, dispatch] = useReducer(reducer, initialState);\n  \n  const handleOnSubmit = e => {\n    e.preventDefault();\n    if (password !== password2) {\n      return setFormData({ ...formData, error: true });\n    } else {\n      const register = async ({ first_name, last_name, email, password }) => {\n        const config = {\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        };\n\n        const body = JSON.stringify({ first_name, last_name, email, password });\n        console.log(\"Action is being called\");\n        try {\n          const res = await axios.post(\"/api/users/signup\", body, config);\n\n          dispatch({\n            type: \"register_success\",\n            payload: res.data\n          });\n        } catch (error) {\n          dispatch({\n            type: \"register_fail\"\n          });\n        }\n      };\n      register({first_name, last_name, email, password})\n    }\n\n  };\n\n  return (\n    <Container component=\"main\" maxWidth=\"xs\">\n      <CssBaseline />\n      <div className={classes.paper}>\n        <GoalIcon />\n        <form className={classes.form} onSubmit={e => handleOnSubmit(e)}>\n          <Grid container spacing={1}>\n            <Grid item xs={12} sm={6}>\n              <TextField\n                name=\"first_name\"\n                value={first_name}\n                onChange={e => handleOnChange(e)}\n                label=\"First Name\"\n                fullWidth\n                variant=\"outlined\"\n                required\n                margin=\"normal\"\n                autoComplete=\"none\"\n                autoFocus\n              />\n            </Grid>\n            <Grid item xs={12} sm={6}>\n              <TextField\n                label=\"Last Name\"\n                name=\"last_name\"\n                value={last_name}\n                onChange={e => handleOnChange(e)}\n                fullWidth\n                variant=\"outlined\"\n                required\n                margin=\"normal\"\n                autoComplete=\"none\"\n              />\n            </Grid>\n          </Grid>\n          <Grid container>\n            <Grid item xs={12}>\n              <TextField\n                label=\"Email\"\n                fullWidth\n                variant=\"outlined\"\n                required\n                margin=\"normal\"\n                name=\"email\"\n                value={email}\n                onChange={e => handleOnChange(e)}\n                autoComplete=\"none\"\n              />\n            </Grid>\n            <Grid item xs={12}>\n              <TextField\n                error={formData.error}\n                label=\"Password\"\n                name=\"password\"\n                value={password}\n                type=\"password\"\n                onChange={e => handleOnChange(e)}\n                fullWidth\n                variant=\"outlined\"\n                required\n                margin=\"normal\"\n              />\n            </Grid>\n            <Grid item xs={12}>\n              <TextField\n                error={formData.error}\n                helperText={formData.error ? \"Passwords do not match\" : null}\n                type=\"password\"\n                label=\"Confirm Password\"\n                fullWidth\n                variant=\"outlined\"\n                required\n                margin=\"normal\"\n                name=\"password2\"\n                value={password2}\n                onChange={e => handleOnChange(e)}\n              />\n            </Grid>\n          </Grid>\n          <Button\n            color=\"primary\"\n            variant=\"contained\"\n            fullWidth\n            type=\"submit\"\n            className={classes.submit}\n          >\n            Sign Up\n          </Button>\n          <Link to=\"/\" style={{ textDecoration: \"none\" }}>\n            Already have an account? Login\n          </Link>\n        </form>\n      </div>\n    </Container>\n  );\n};\n\nexport default Signup;\n"]},"metadata":{},"sourceType":"module"}